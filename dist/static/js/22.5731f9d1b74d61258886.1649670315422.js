webpackJsonp([22],{"Ca/b":function(t,a){},FuHZ:function(t,a,e){"use strict";Object.defineProperty(a,"__esModule",{value:!0});var s=e("IHPB"),i=e.n(s),n=e("HzJ8"),l=e.n(n),o=e("dNAe"),r={data:function(){return{flag:!1,tableData:[],pageControl:{pageNumber:1,pageSize:10,total:0},subData:{info:{},attachment:[]},visible:!1}},created:function(){this.query(this.pageControl.pageNumber)},methods:{query:function(t){var a=this;this.pageControl.pageNumber=t,Object(o.b)({page:t,limit:this.pageControl.pageSize}).then(function(t){if(t){a.flag=!0;var e=!0,s=!1,i=void 0;try{for(var n,o=l()(t.data);!(e=(n=o.next()).done);e=!0){n.value.show=!1}}catch(t){s=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(s)throw i}}a.tableData=t.data,a.tableData[0].show=!0,a.pageControl.total=t.total}})},handleCurrentChange:function(t){this.query(t)},handleSizeChange:function(t){this.pageControl.pageSize=t,this.query(1)},create:function(){this.$router.push({path:"/league_create"})},showDetail:function(t){this.$router.push({path:"/league_detail",query:{id:t.id}})},goBs:function(t){this.$router.push({path:"/league_reimburse",query:{id:t.id}})},openDetail:function(t){t.show=!t.show},subAgain:function(t){var a=this;this.$http.get("/get_pay_detail",{id:t.id}).then(function(t){if(t){var e=!0,s=!1,i=void 0;try{for(var n,o=l()(t.attachment||[]);!(e=(n=o.next()).done);e=!0){var r=n.value;r.name=r.file_name,r.url=r.file_path}}catch(t){s=!0,i=t}finally{try{!e&&o.return&&o.return()}finally{if(s)throw i}}a.subData=t,a.visible=!0}})},submitForm:function(){var t=this;this.$http.post("/add_pay_detail",{old_pay_detail_id:this.subData.info.id,pay_company:[{pay_company_id:this.subData.info.pay_company_id,pay_company_name:this.subData.info.company_name,pay_user_num:this.subData.info.pay_user_num,user_ids:this.subData.info.user_ids,pay_money:this.subData.info.pay_money,remark:this.subData.info.remark||"",attachment:[].concat(i()(this.subData.attachment.map(function(t){return{file_name:t.name,file_path:t.url}})))}]}).then(function(a){a&&(t.$message({type:"success",message:"重新提交成功"}),t.visible=!1,t.query(t.pageControl.pageNumber))})},handlePreview:function(t){window.open(t.url)},handleRemove:function(t,a){var e=a.findIndex(function(a){return a.uid==t.uid});this.subData.attachment.splice(e,1)},handleChange:function(t,a){},beforeUpload:function(t){},uploadAttach:function(t){var a=this;Object(o.q)(t.file).then(function(e){if(e){var s={name:t.file.name,url:e.path};a.subData.attachment=[].concat(i()(a.subData.attachment),[s])}})}}},c={render:function(){var t=this,a=t.$createElement,e=t._self._c||a;return e("div",{staticClass:"out_wrap"},[e("div",{staticClass:"right mb22"},[e("el-button",{attrs:{type:"primary"},on:{click:function(a){return t.$router.push("/system")}}},[t._v("团建制度")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.create}},[t._v("发起团建")])],1),t._v(" "),t.flag&&t.tableData.length?e("div",t._l(t.tableData,function(a,s){return e("div",{key:s,staticClass:"item bf1 mb22 pointer"},[e("div",{staticClass:"flex_between",on:{click:function(e){return t.showDetail(a)}}},[e("div",{staticClass:"flex1"},[e("div",{staticClass:"ellipsis mb15",attrs:{title:a.name}},[t._v(t._s(a.name))]),t._v(" "),e("div",{staticClass:"flex_between"},[e("div",{staticClass:"flex1"},[t._v(t._s(a.user_name)+"发起")]),t._v(" "),e("div",{staticClass:"flex1"},[t._v("\n              "+t._s(t.$dateFormat(1e3*a.create_time,1))+"\n            ")]),t._v(" "),e("div",{staticClass:"flex1"},["活动"!=a.activity_type?e("el-tag",{attrs:{type:"success"}},[t._v(t._s(a.activity_type))]):t._e(),t._v(" "),e("el-tooltip",{attrs:{effect:"dark",content:a.other,placement:"top"}},["活动"==a.activity_type?e("el-tag",{attrs:{type:"success"}},[t._v("活动")]):t._e()],1)],1)])]),t._v(" "),e("div",{staticStyle:{margin:"0 50px"}},[0==a.status?e("span",{staticClass:"wait"},[t._v("待审核")]):t._e(),t._v(" "),1==a.status?e("span",{staticClass:"able"},[t._v("已同意")]):t._e(),t._v(" "),2==a.status?e("span",{staticClass:"dis"},[t._v("已拒绝")]):t._e()]),t._v(" "),e("div",{staticStyle:{width:"50px",margin:"0 50px"}},[1==a.cost_status&&1==a.status?e("a",{staticClass:"able",on:{click:function(e){return e.stopPropagation(),t.goBs(a)}}},[t._v("去报销")]):t._e(),t._v(" "),2==a.cost_status?e("a",{staticClass:"wait"},[t._v("报销中")]):t._e(),t._v(" "),3==a.cost_status?e("a",{staticClass:"return"},[t._v("已报销")]):t._e()]),t._v(" "),e("i",{staticClass:"detail_ico c9 pointer",class:{"el-icon-arrow-down":!a.show,"el-icon-arrow-up":a.show},on:{click:function(e){return e.stopPropagation(),t.openDetail(a)}}})]),t._v(" "),a.show?e("div",{staticClass:"item_detail"},[a.pay_detail_list.length?t._e():e("div",{staticClass:"center c9"},[t._v("\n          无报销明细\n        ")]),t._v(" "),a.pay_detail_list.length?e("div",t._l(a.pay_detail_list,function(a,s){return e("div",{key:s,staticClass:"flex_between"},[e("div",{staticClass:"flex1"},[t._v(t._s(a.oa_main_id))]),t._v(" "),e("div",{staticClass:"flex1"},[t._v(t._s(a.company_name))]),t._v(" "),e("div",{staticClass:"flex1"},[t._v("\n              报销金额："+t._s(a.pay_money)),e("span",{staticClass:"ml20"},[t._v("报销人数："+t._s(a.pay_user_num))])]),t._v(" "),e("div",{staticStyle:{margin:"0 20px"}},[1==a.process_state?e("span",{staticClass:"able"},[t._v("已完成")]):t._e(),t._v(" "),2==a.process_state?e("span",{staticClass:"return"},[t._v("已撤销")]):t._e(),t._v(" "),3==a.process_state?e("span",{staticClass:"wait"},[t._v("待审批")]):t._e(),t._v(" "),4==a.process_state?e("span",{staticClass:"dis"},[t._v("已拒绝")]):t._e()]),t._v(" "),e("div",{staticStyle:{width:"70px","margin-left":"120px"}},[e("a",{staticClass:"active_color",attrs:{href:a.approve_url,target:"_blank"}},[t._v("审批详情")])]),t._v(" "),e("div",{staticClass:"right",staticStyle:{width:"70px","margin-left":"120px"}},[1!=a.process_state?e("a",{staticClass:"active_color",on:{click:function(e){return e.stopPropagation(),t.subAgain(a)}}},[t._v("重新提交")]):t._e()])])}),0):t._e()]):t._e()])}),0):t._e(),t._v(" "),t.flag&&!t.tableData.length?e("div",{staticClass:"flex_center c9"},[t._v("暂无数据")]):t._e(),t._v(" "),e("el-dialog",{attrs:{title:"重新提交",visible:t.visible},on:{"update:visible":function(a){t.visible=a}}},[e("el-form",{attrs:{model:t.subData,"label-width":"100px"}},[e("el-form-item",{attrs:{label:"付款公司："}},[e("el-input",{attrs:{type:"text",placeholder:"付款公司",readonly:""},model:{value:t.subData.info.company_name,callback:function(a){t.$set(t.subData.info,"company_name",a)},expression:"subData.info.company_name"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"付款人数："}},[t._v(t._s(t.subData.info.pay_user_num||0)+"人")]),t._v(" "),e("el-form-item",{attrs:{label:"付款金额："}},[t._v(t._s(t.subData.info.pay_money||"0.00")+"元")]),t._v(" "),e("el-form-item",{attrs:{label:"备注："}},[e("el-input",{attrs:{type:"textarea",rows:3,placeholder:"请输入备注",resize:"none"},model:{value:t.subData.info.remark,callback:function(a){t.$set(t.subData.info,"remark",a)},expression:"subData.info.remark"}})],1),t._v(" "),e("el-form-item",{attrs:{label:"附件："}},[e("el-upload",{attrs:{action:"#",multiple:!1,"show-file-list":"","auto-upload":!0,"on-preview":t.handlePreview,"on-remove":t.handleRemove,"on-change":t.handleChange,"before-upload":t.beforeUpload,"file-list":t.subData.attachment,"http-request":t.uploadAttach}},[e("a",{staticClass:"active_color"},[t._v("添加附件")])])],1)],1),t._v(" "),e("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:function(a){t.visible=!1}}},[t._v("取消")]),t._v(" "),e("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确定")])],1)],1),t._v(" "),t.tableData.length>0?e("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.pageControl.pageNumber,"page-size":t.pageControl.pageSize,"page-sizes":t.pagesizes,total:t.pageControl.total},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}}):t._e()],1)},staticRenderFns:[]};var _=e("C7Lr")(r,c,!1,function(t){e("Ca/b")},"data-v-0a188e1b",null);a.default=_.exports}});