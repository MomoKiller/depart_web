webpackJsonp([14],{igin:function(e,t){},nHup:function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=r("4YfN"),n=r.n(a),o=r("IHPB"),l=r.n(o),i=r("dNAe"),s={data:function(){return{pageControl:{pageNumber:1,pageSize:10,total:0},tableData:[],adminArr:[],nodeArr:[],mode:1,visible:!1,ruleForm:{},rules:{user_id:[{required:!0,message:"请选择管理员",trigger:"change"}],power:[{required:!0,message:"请选择权限",trigger:"change"}]}}},created:function(){var e=this;this.query(this.pageControl.pageNumber),Object(i.l)().then(function(t){t&&(e.nodeArr=t)})},methods:{query:function(e){var t=this;this.pageControl.pageNumber=e,Object(i.i)({page:e,limit:this.pageControl.pageSize}).then(function(e){e&&(t.tableData=e.data,t.pageControl.total=e.total)})},handleCurrentChange:function(e){this.query(e)},handleSizeChange:function(e){this.pageControl.pageSize=e,this.query(1)},add:function(){var e=this;Object(i.m)().then(function(t){t&&(e.adminArr=t,e.mode=1,e.ruleForm={},e.visible=!0,e.$nextTick(function(){e.$refs.ruleForm.clearValidate(["user_id","power"])}))})},edit:function(e){var t=this;this.mode=2,e.power=[].concat(l()(e.str_nodes.map(function(e){return e.id}))),this.ruleForm=n()({},e),this.visible=!0,this.$nextTick(function(){t.$refs.ruleForm.clearValidate(["user_id","power"])})},del:function(e){var t=this;this.$confirm("确定删除该管理员吗？","删除提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http.post("/adminapi/role/del_admin",{id:e.id}).then(function(e){e&&(t.$message({type:"success",message:"删除成功!"}),t.query(t.pageControl.pageNumber))})}).catch(function(){})},submitForm:function(e){var t=this;this.$refs[e].validate(function(e){e&&t.$http.post(1==t.mode?"/adminapi/role/add_admin":"/adminapi/role/edit_admin",1==t.mode?{user_id:t.ruleForm.user_id,node:t.ruleForm.power.toString()}:{id:t.ruleForm.id,node:t.ruleForm.power.toString()}).then(function(e){e&&(t.$message({type:"success",message:1==t.mode?"添加成功":"编辑成功"}),t.query(t.pageControl.pageNumber),t.visible=!1)})})}}},u={render:function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{staticClass:"out_wrap"},[r("p",{staticClass:"right"},[r("el-button",{attrs:{type:"primary"},on:{click:e.add}},[e._v("添加管理员")])],1),e._v(" "),r("el-table",{staticClass:"w100",attrs:{data:e.tableData,"tooltip-effect":"dark"}},[r("el-table-column",{attrs:{prop:"name",label:"管理员",width:"200","show-overflow-tooltip":""}}),e._v(" "),r("el-table-column",{attrs:{label:"权限","min-width":"200"},scopedSlots:e._u([{key:"default",fn:function(t){return e._l(t.row.str_nodes,function(t,a){return r("el-tag",{key:a,attrs:{size:"small"}},[e._v(e._s(t.name))])})}}])}),e._v(" "),r("el-table-column",{attrs:{label:"操作",width:"100"},scopedSlots:e._u([{key:"default",fn:function(t){return[r("a",{staticClass:"edit",on:{click:function(r){return e.edit(t.row)}}},[e._v("编辑")]),e._v(" "),r("a",{staticClass:"del",on:{click:function(r){return e.del(t.row)}}},[e._v("删除")])]}}])})],1),e._v(" "),e.tableData.length>0?r("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":e.pageControl.pageNumber,"page-size":e.pageControl.pageSize,"page-sizes":e.pagesizes,total:e.pageControl.total},on:{"current-change":e.handleCurrentChange,"size-change":e.handleSizeChange}}):e._e(),e._v(" "),r("el-dialog",{attrs:{title:1==e.mode?"添加管理员":"编辑管理员",visible:e.visible},on:{"update:visible":function(t){e.visible=t}}},[r("el-form",{ref:"ruleForm",attrs:{model:e.ruleForm,rules:e.rules,"label-width":"80px"}},[1==e.mode?r("el-form-item",{attrs:{label:"管理员：",prop:"user_id"}},[r("el-select",{staticClass:"w100",attrs:{clearable:"",filterable:"",placeholder:"请选择管理员"},model:{value:e.ruleForm.user_id,callback:function(t){e.$set(e.ruleForm,"user_id",t)},expression:"ruleForm.user_id"}},e._l(e.adminArr,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.user_id}})}),1)],1):r("el-form-item",{attrs:{label:"管理员："}},[r("el-input",{attrs:{type:"text",placeholder:"管理员名称",disabled:""},model:{value:e.ruleForm.name,callback:function(t){e.$set(e.ruleForm,"name",t)},expression:"ruleForm.name"}})],1),e._v(" "),r("el-form-item",{attrs:{label:"权限：",prop:"power"}},[r("el-select",{staticClass:"w100",attrs:{clearable:"",filterable:"",multiple:"",placeholder:"请选择权限"},model:{value:e.ruleForm.power,callback:function(t){e.$set(e.ruleForm,"power",t)},expression:"ruleForm.power"}},e._l(e.nodeArr,function(e,t){return r("el-option",{key:t,attrs:{label:e.name,value:e.id}})}),1)],1)],1),e._v(" "),r("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[r("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),r("el-button",{attrs:{type:"primary"},on:{click:function(t){return e.submitForm("ruleForm")}}},[e._v("确定")])],1)],1)],1)},staticRenderFns:[]};var c=r("C7Lr")(s,u,!1,function(e){r("igin")},"data-v-7dbf6f22",null);t.default=c.exports}});