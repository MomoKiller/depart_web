webpackJsonp([20],{ADCg:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=a("4YfN"),l=a.n(s),i=a("KH7x"),n=a.n(i),o=[{key:0,value:"待审批",class:"wait"},{key:1,value:"已通过",class:"active_color"},{key:2,value:"已拒绝",class:"dis"}],r={data:function(){return{activeTab:"pending",pageControl:{pageNumber:1,pageSize:10,total:0},tableData:[],mode:1,visible:!1,reason:"",obj:{},flag:!1,activeNames:[],detailsVisible:!1,detailsData:[],keyword:""}},created:function(){this.query(this.pageControl.pageNumber)},filters:{statusFilter:function(t){var e=o.filter(function(e){return e.key==t});return n()(e,1)[0].value}},methods:{statusClass:function(t){var e=o.filter(function(e){return e.key==t});return n()(e,1)[0].class},query:function(t){var e=this;"pending"==this.activeTab?this.$http.post("/act_approve_list",{page:t,limit:this.pageControl.pageSize,keyword:this.keyword}).then(function(t){t&&(e.flag=!0,e.tableData=t.data,e.pageControl.total=t.total)}):this.$http.post("/act_approved_list",{page:t,limit:this.pageControl.pageSize,keyword:this.keyword}).then(function(t){t&&(e.flag=!0,e.tableData=t.data,e.pageControl.total=t.total)})},handleChange:function(){this.flag=!1,this.query(1)},handleCurrentChange:function(t){this.query(t)},handleSizeChange:function(t){this.pageControl.pageSize=t,this.query(1)},pass:function(t){this.mode=1,this.obj=l()({},t),this.reason="",this.visible=!0},refuse:function(t){this.mode=2,this.obj=l()({},t),this.reason="",this.visible=!0},submitForm:function(){var t=this;this.$http.post("/deal_approve",{id:this.obj.id,operate_type:this.mode,approval_reason:this.reason}).then(function(e){e&&(t.visible=!1,t.detailsVisible=!1,t.$message({type:"success",message:1==t.mode?"通过成功":"驳回成功"}),t.query(t.pageControl.pageNumber))})},showDetail:function(t){this.$router.push({path:"/league_detail",query:{id:t.id}})},handleApproval:function(t){this.detailsData=[t],this.detailsVisible=!0}}},c={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"wrap"},[a("div",{staticClass:"out_wrap"},[a("section",[a("el-select",{attrs:{placeholder:"请选择",title:"审批状态"},on:{change:t.handleChange},model:{value:t.activeTab,callback:function(e){t.activeTab=e},expression:"activeTab"}},[a("el-option",{attrs:{label:"待审批",value:"pending"}},[t._v("待审批")]),t._v(" "),a("el-option",{attrs:{label:"已审批",value:"finish"}},[t._v("已审批")])],1),t._v(" "),a("el-input",{staticStyle:{width:"250px","margin-left":"10px"},attrs:{placeholder:"搜索团建主题、发起人、团建地点",title:"搜索团建主题、发起人、团建地点"},on:{change:t.handleChange},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}})],1)]),t._v(" "),a("div",{staticClass:"out_wrap mt20"},[a("el-table",{staticClass:"w100",attrs:{data:t.tableData,"row-key":"id",lazy:"","tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"name",label:"团建主题","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"company_name",label:"团建形式","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return["活动"!=e.row.activity_type?a("span",[t._v("\r\n            "+t._s(e.row.activity_type)+"\r\n          ")]):t._e(),t._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:e.row.other,placement:"top"}},["活动"==e.row.activity_type?a("span",[t._v("活动")]):t._e()])]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"user_name",label:"发起人",width:"100","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"create_time",label:"发起时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n          "+t._s(t.$dateFormat(1e3*e.row.create_time,1))+"\r\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"start_date",label:"团建时间","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\r\n          "+t._s(e.row.start_date+"~"+e.row.end_date)+"\r\n        ")]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"location",label:"团建地点","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"pay_in_advance",label:"预估团建费",width:"120","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"user_num",label:"团建人员",width:"100","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"approval_status",label:"审批状态",width:"100","show-overflow-tooltip":""}},[[t._v("\r\n          "+t._s("pending"==t.activeTab?"待审批":"已审批")+"\r\n        ")]],2),t._v(" "),a("el-table-column",{attrs:{label:"操作",fixed:"right",width:"60"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){return t.handleApproval(e.row)}}},[t._v("\r\n            "+t._s("pending"==t.activeTab?"审批":"查看")+"\r\n            ")])]}}])})],1),t._v(" "),a("el-dialog",{attrs:{title:"团建详情",width:"70%",visible:t.detailsVisible},on:{"update:visible":function(e){t.detailsVisible=e}}},t._l(t.detailsData,function(e,s){return a("el-card",{key:s,staticClass:"box-card",staticStyle:{"margin-bottom":"20px"},attrs:{shadow:"never"}},[a("el-row",{staticClass:"lh30 mb5"},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple"},[a("span",{staticClass:"grid-label"},[t._v("团建主题：")]),t._v(t._s(e.name)+"\r\n            ")])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple"},[a("span",{staticClass:"grid-label"},[t._v("团建形式：")]),t._v(" "),"活动"!=e.activity_type?a("span",[t._v("\r\n                "+t._s(e.activity_type)+"\r\n              ")]):t._e(),t._v(" "),a("el-tooltip",{attrs:{effect:"dark",content:e.other,placement:"top"}},["活动"==e.activity_type?a("span",[t._v("活动")]):t._e()])],1)]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple"},[a("span",{staticClass:"grid-label"},[t._v("发起人：")]),t._v(t._s(e.user_name)+"\r\n              "),a("span",{staticStyle:{"margin-left":"5px"}},[t._v("("+t._s(t.$dateFormat(1e3*e.create_time,1))+")")])])])],1),t._v(" "),a("el-row",{staticClass:"lh30 mb5"},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple"},[a("span",{staticClass:"grid-label"},[t._v("团建时间：")]),t._v(t._s(e.start_date+"~"+e.end_date)+"\r\n            ")])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple"},[a("span",{staticClass:"grid-label"},[t._v("团建地点：")]),t._v(t._s(e.location)+"\r\n            ")])]),t._v(" "),a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple"},[a("span",{staticClass:"grid-label"},[t._v("团建描述：")]),t._v(t._s(e.desc)+"\r\n            ")])])],1),t._v(" "),a("el-row",{staticClass:"lh30 mb5"},[a("el-col",{attrs:{span:8}},[a("div",{staticClass:"grid-content bg-purple"},[a("span",{staticClass:"grid-label"},[t._v("预估团建费：")]),t._v(t._s(e.pay_in_advance)+" 元\r\n            ")])])],1),t._v(" "),a("el-row",{staticClass:"lh30 mb5"},[a("el-col",{staticClass:"flex",attrs:{span:24}},[a("span",{staticClass:"grid-label"},[t._v("团建人员：")]),t._v(" "),a("el-collapse",{staticClass:"left90",model:{value:t.activeNames,callback:function(e){t.activeNames=e},expression:"activeNames"}},[a("el-collapse-item",{attrs:{title:"共"+e.user_num+"人",name:"1"}},[a("div",{staticClass:"flex1"},t._l(e.departs||[],function(e,s){return a("div",{key:s,staticClass:"mb15"},[t._v("\r\n                    "+t._s(e.name)+"：\r\n                    "),t._l(e.users||[],function(e,s){return a("el-tag",{key:s,attrs:{size:"small",effect:"plain"}},[t._v(t._s(e.name))])})],2)}),0)])],1)],1)],1),t._v(" "),a("el-divider"),t._v(" "),a("section",{staticClass:"between"},[a("div",t._l(e.approve_list||[],function(e,s){return a("div",{key:s,staticClass:"mb15 flex"},[a("div",[t._v(t._s(e.name))]),t._v(" "),a("div",{staticClass:"ml20",class:t.statusClass(e.approval_opinions)},[t._v(t._s(t._f("statusFilter")(e.approval_opinions)))]),t._v(" "),a("div",{staticClass:"ml20 c9"},[t._v("\r\n                "+t._s(t.$dateFormat(1e3*e.approval_time,1))+"\r\n              ")]),t._v(" "),a("div",{staticClass:"flex1 ml20",staticStyle:{"line-height":"180%"}},[t._v("\r\n                "+t._s(e.approval_reason)+"\r\n              ")])])}),0),t._v(" "),"pending"==t.activeTab?a("div",{staticClass:"grid-content bg-purple flex_middle"},[a("el-button",{attrs:{type:"primary"},on:{click:function(a){return a.stopPropagation(),t.pass(e)}}},[t._v("通过")]),t._v(" "),a("el-button",{attrs:{plain:""},on:{click:function(a){return a.stopPropagation(),t.refuse(e)}}},[t._v("驳回")])],1):t._e()])],1)}),1),t._v(" "),a("el-dialog",{attrs:{title:1==t.mode?"审批通过":"审批驳回",visible:t.visible},on:{"update:visible":function(e){t.visible=e}}},[a("el-input",{attrs:{type:"textarea",placeholder:"请输入内容",rows:5,resize:"none"},model:{value:t.reason,callback:function(e){t.reason=e},expression:"reason"}}),t._v(" "),a("div",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(e){t.visible=!1}}},[t._v("取消")]),t._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:t.submitForm}},[t._v("确定")])],1)],1),t._v(" "),t.tableData.length>0?a("el-pagination",{attrs:{background:"",layout:"total, sizes, prev, pager, next, jumper","current-page":t.pageControl.pageNumber,"page-size":t.pageControl.pageSize,"page-sizes":t.pagesizes,total:t.pageControl.total},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}}):t._e()],1),t._v(" "),(t.activeTab,t._e()),t._v(" "),(t.activeTab,t._e())])},staticRenderFns:[]};var p=a("C7Lr")(r,c,!1,function(t){a("iJ/f")},"data-v-25f84dc1",null);e.default=p.exports},"iJ/f":function(t,e){}});