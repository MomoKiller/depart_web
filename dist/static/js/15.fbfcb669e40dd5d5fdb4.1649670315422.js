webpackJsonp([15],{BC7D:function(t,e,a){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var o=a("beg3"),r=a("YO/D"),l={data:function(){return{queryControl:{company_id:"",depart_id:"",status:"",year:"",keywords:""},pageControl:{pageNumber:1,pageSize:10,total:0},tableData:[],num:0,user:0}},filters:{formateDate:function(t){var e=new Date(1e3*t),a=e.getFullYear(),o=e.getMonth()+1;o=o<10?"0"+o:o;var r=e.getDate();r=r<10?"0"+r:r;var l=e.getHours();l=l<10?"0"+l:l;var n=e.getMinutes(),s=e.getSeconds();return a+"-"+o+"-"+r+" "+l+":"+(n=n<10?"0"+n:n)+":"+(s=s<10?"0"+s:s)}},created:function(){this.query(this.pageControl.pageNumber)},methods:{query:function(t){var e=this;this.pageControl.pageNumber=t,this.$http.get("/adminapi/activity/activity_list",{year:this.queryControl.year?new Date(this.queryControl.year).getFullYear():"",company_id:this.queryControl.company_id,depart_id:this.queryControl.depart_id,status:""===this.queryControl.status?-1:this.queryControl.status,page:t,limit:this.pageControl.pageSize,keywords:this.queryControl.keywords}).then(function(t){t&&(e.tableData=t.list.data,e.pageControl.total=t.list.total,e.num=t.total_num,e.user=t.total_user)})},handleCurrentChange:function(t){this.query(t)},handleSizeChange:function(t){this.queryControl.pageSize=t,this.query(1)},exportFile:function(){this.$http.get("/adminapi/activity/export_activity_list",{year:this.queryControl.year?new Date(this.queryControl.year).getFullYear():"",company_id:this.queryControl.company_id,depart_id:this.queryControl.depart_id,status:""===this.queryControl.status?-1:this.queryControl.status,keywords:this.queryControl.keywords},null,{responseType:"blob"}).then(function(t){if(t){var e=window.URL.createObjectURL(new Blob([t]),{type:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet;charset=utf-8"}),a=document.createElement("a");a.href=e,a.download="团建列表.xls",document.body.appendChild(a),a.click(),document.body.removeChild(a),window.URL.revokeObjectURL(e)}})},dumpDetail:function(t){var e=t.id,a=t.act_type;this.$router.push({path:"/league_detail",query:{id:e,type:a}})}},components:{ComCompany:o.a,ComProject:r.a}},n={render:function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",{staticClass:"out_wrap"},[a("div",{staticClass:"flex_between search mb22"},[a("div",{staticClass:"left"},[a("el-date-picker",{attrs:{type:"year",placeholder:"选择年份",editable:!1,clearable:"",disabled:!1,"picker-options":t.$pickOption(1)},on:{change:function(e){return t.query(1)}},model:{value:t.queryControl.year,callback:function(e){t.$set(t.queryControl,"year",e)},expression:"queryControl.year"}}),t._v(" "),a("com-company",{staticClass:"w150 inline",attrs:{id:t.queryControl.company_id},on:{Cchange:function(e){t.queryControl.company_id=e,t.query(1)}}}),t._v(" "),a("com-project",{staticClass:"w150 inline",attrs:{id:t.queryControl.depart_id},on:{Dchange:function(e){t.queryControl.depart_id=e,t.query(1)}}}),t._v(" "),a("el-select",{staticClass:"w150",attrs:{placeholder:"请选择团建状态",clearable:"",filterable:""},on:{change:function(e){return t.query(1)}},model:{value:t.queryControl.status,callback:function(e){t.$set(t.queryControl,"status",e)},expression:"queryControl.status"}},[a("el-option",{attrs:{label:"待审核",value:"0"}}),t._v(" "),a("el-option",{attrs:{label:"已同意",value:"1"}}),t._v(" "),a("el-option",{attrs:{label:"已拒绝",value:"2"}}),t._v(" "),a("el-option",{attrs:{label:"已撤销",value:"3"}})],1),t._v(" "),a("el-input",{staticClass:"w150 inline",attrs:{placeholder:"关键字搜索",title:"关键字搜索"},on:{input:function(e){return t.query(1)}},model:{value:t.queryControl.keywords,callback:function(e){t.$set(t.queryControl,"keywords",e)},expression:"queryControl.keywords"}})],1),t._v(" "),a("div",{staticClass:"right"},[a("el-button",{attrs:{type:"primary"},on:{click:t.exportFile}},[t._v("导出")])],1)]),t._v(" "),a("div",{staticClass:"fs16 bf1 mb22",staticStyle:{padding:"15px 30px"}},[a("span",[t._v("团建次数："),a("span",{staticClass:"bold"},[t._v(t._s(t.num||0)+"次")])]),t._v(" "),a("span",{staticClass:"ml20"},[t._v("涉及人数："),a("span",{staticClass:"bold"},[t._v(t._s(t.user||0)+"人")])])]),t._v(" "),a("el-table",{staticClass:"w100",attrs:{data:t.tableData,"tooltip-effect":"dark"}},[a("el-table-column",{attrs:{prop:"name",label:"团建活动","min-width":"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"user_name",label:"申请人",width:"100","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"depart_name",label:"申请部门","min-width":"180","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"user_num",label:"参与人数",width:"100","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"activity_type",label:"团建形式",width:"100","show-overflow-tooltip":""}}),t._v(" "),a("el-table-column",{attrs:{prop:"other",label:"申请时间",width:"170","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v(t._s(t._f("formateDate")(e.row.create_time)))]}}])}),t._v(" "),a("el-table-column",{attrs:{prop:"act_date",label:"团建时间",width:"180","show-overflow-tooltip":""},scopedSlots:t._u([{key:"default",fn:function(e){return[t._v("\n        "+t._s(e.row.start_date+"至"+e.row.end_date)+"\n      ")]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"状态",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[0==e.row.status?a("div",[a("span",{staticClass:"waitBadge"}),t._v("待审核\n        ")]):t._e(),t._v(" "),1==e.row.status?a("div",[a("span",{staticClass:"ableBadge"}),t._v("已同意\n        ")]):t._e(),t._v(" "),2==e.row.status?a("div",[a("span",{staticClass:"disBadge"}),t._v("已拒绝\n        ")]):t._e(),t._v(" "),3==e.row.status?a("div",[a("span",{staticClass:"disBadge"}),t._v("已撤销\n        ")]):t._e()]}}])}),t._v(" "),a("el-table-column",{attrs:{label:"操作",width:"80"},scopedSlots:t._u([{key:"default",fn:function(e){return[a("a",{staticClass:"active_color",on:{click:function(a){return t.dumpDetail(e.row)}}},[t._v("详情")])]}}])})],1),t._v(" "),t.tableData.length>0?a("el-pagination",{attrs:{background:"",layout:"total, prev, pager, next, jumper","current-page":t.pageControl.pageNumber,"page-size":t.pageControl.pageSize,"page-sizes":t.pagesizes,total:t.pageControl.total},on:{"current-change":t.handleCurrentChange,"size-change":t.handleSizeChange}}):t._e()],1)},staticRenderFns:[]};var s=a("C7Lr")(l,n,!1,function(t){a("Lpo8")},"data-v-73ac8470",null);e.default=s.exports},Lpo8:function(t,e){}});